# Makefile.in -- Makefile for Khepera documentation
# Created: Sun Jan  8 21:44:38 1995 by faith@cs.unc.edu
# Revised: Wed May 21 00:56:52 1997 by faith@acm.org
# Copyright 1995, 1996, 1997 Rickard E. Faith (faith@acm.org)
# 
# Permission is hereby granted, free of charge, to any person obtaining
# a copy of this software and associated documentation files (the
# "Software"), to deal in the Software without restriction, including
# without limitation the rights to use, copy, modify, merge, publish,
# distribute, sublicense, and/or sell copies of the Software, and to
# permit persons to whom the Software is furnished to do so, subject to
# the following conditions:
# 
# The above copyright notice and this permission notice shall be
# included in all copies or substantial portions of the Software.
# 
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
# EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
# MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
# NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
# LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
# OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
# WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

.SUFFIXES:

srcdir=		@srcdir@
VPATH=		@srcdir@
prefix=		@prefix@
exec_prefix=	@exec_prefix@
LATEX=		@LATEX@
PERL=		@PERL@
FIG2DEV=	@FIG2DEV@
DVIPS=          @DVIPS@
REFBIBTEX=      @REFBIBTEX@
BIBTEX=         @BIBTEX@

SHELL=	/bin/sh

LIBMAA_SOURCES= ../maa.h ../maa.c ../arg.c ../base26.c ../base64.c \
	../bit.c ../debug.c ../error.c ../flags.c ../hash.c ../list.c \
	../memory.c ../parse-concrete.c ../pr.c ../prime.c \
	../set.c ../sl.c ../source.c ../stack.c ../string.c ../text.c \
	../timer.c

FIGS=
SLIDEFIGS=

TEMPORARIES=general.tex

libmaa.dvi: libmaa.tex $(TEMPORARIES) $(FIGS)

all: libmaa.dvi

libmaa.bib:
	if $(REFBIBTEX) -j libmaa.tex $(TEMPORARIES) > $@.tmp; then \
		touch $@; \
	fi
	cmp -s $@ $@.tmp || mv $@.tmp $@
	-rm -f $@.tmp

general.tex: $(LIBMAA_SOURCES)
	$(PERL) extract.pl $(LIBMAA_SOURCES) > general.tex

%.300dpi.ps: %.dvi
	if fgrep 'LANDSCAPE MODE' $*.log > /dev/null; then \
		$(DVIPS) -D300 -t landscape -o $@ $*; \
	else \
		$(DVIPS) -D300 -o $@ $*; \
	fi

%.600dpi.ps: %.dvi
	if fgrep 'LANDSCAPE MODE' $*.log > /dev/null; then \
		$(DVIPS) -D600 -t landscape -o $@ $*; \
	else \
		$(DVIPS) -D600 -o $@ $*; \
	fi

%.stamp: %.tex
	test -f $*.stamp || cp $*.aux $*.stamp || touch $*.stamp
	$(LATEX) $*
	cmp -s $*.stamp $*.aux || cp $*.aux $*.stamp

%.dvi: %.bbl %.tex %.stamp
	if fgrep 'LaTeX Warning: Label' $*.log>/dev/null; then $(LATEX) $*; fi
	if fgrep 'LaTeX Warning: Label' $*.log>/dev/null; then $(LATEX) $*; fi
	if fgrep 'LaTeX Warning: Label' $*.log>/dev/null; then $(LATEX) $*; fi

%.bbl: %.bib %.stamp
	test ! -s $*.bib || $(BIBTEX) $*


.PRECIOUS: %.aux %.bib %.bbl %.blg

.PHONY: clean distclean
clean:
	-rm -f *.o *~ core a.out config.log $(EXES) $(FIGS) $(SLIDEFIGS)
	-rm -f *.log *.aux *.toc *.dvi *.lj $(TEMPORARIES)
	-rm -f *.bbl *.blg *.stamp

distclean: clean
	-rm -f config.h config.cache Makefile


# This is from the textutils-1.11 lib/Makefile.in
subdir=doc
Makefile: Makefile.in ../config.status
	cd .. && CONFIG_FILES=$(subdir)/$@ CONFIG_HEADERS= ./config.status
